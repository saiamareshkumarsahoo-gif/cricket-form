<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Registration ‚Äî BPUT Night Tournament</title>

<style>
  body {
    font-family:"Cinzel",serif;
    background: linear-gradient(rgba(0,0,0,0.45),rgba(0,0,0,0.45)),
    url('https://raw.githubusercontent.com/saiamareshkumarsahoo-gif/cricket-form/main/bg.jpg.jpeg')
    no-repeat center center fixed;
    background-size:cover;
    padding:20px;
    color:#f7f7f7;
  }

  .container{
    max-width:600px;
    margin:auto;
    background:rgba(255,248,235,0.95);
    padding:28px;
    border-radius:18px;
    border:4px solid #c8a45b;
    box-shadow:0 0 25px rgba(0,0,0,0.7);
    animation:fadeIn 0.8s ease-out;
    color:#3b2f1e;
  }

  @keyframes fadeIn { from{opacity:0; transform:scale(0.95);} to{opacity:1; transform:scale(1);} }

  h1{
    text-align:center;
    font-size:27px;
    letter-spacing:1px;
    margin-bottom:22px;
    text-shadow:0 0 8px #fff3ba;
    color:#4b3515;
    font-weight:800;
  }

  label{
    font-size:17px;
    font-weight:700;
    display:block;
    margin-bottom:6px;
  }

  .required-star{
    color:red;
    font-size:18px;
  }

  input,select{
    width:100%;
    padding:13px;
    margin-bottom:20px;
    border-radius:10px;
    border:2px solid #d1b67a;
    background:#fff6dd;
    font-size:16px;
    transition:0.2s;
  }

  input:focus,select:focus{
    border-color:#b48a3b;
    box-shadow:0 0 10px #b48a3b;
    transform:scale(1.02);
  }

  button{
    width:100%;
    background:#b48a3b;
    color:white;
    padding:14px;
    border:none;
    border-radius:12px;
    font-size:19px;
    cursor:pointer;
    letter-spacing:1px;
    transition:0.3s;
    font-weight:700;
  }

  button:hover{
    background:#8e6b2a;
    transform:scale(1.03);
    box-shadow:0 0 12px #bfa35f;
  }

  .img-preview{
    max-width:120px;
    border-radius:10px;
    border:2px solid #d4c295;
    display:none;
    margin-top:10px;
  }

  .small{
    font-size:13px;
    margin-left:5px;
    color:#4b371a;
  }

</style>

</head>
<body>

<div class="container">

  <h1>REGISTRATION FORM FOR NIGHT TOURNAMENT ‚Äî BPUT</h1>

  <form id="regForm">

    <label>Player Name <sup class="required-star">*</sup></label>
    <input name="playerName" type="text" placeholder="Enter Player Name" required />

    <label>Branch Name <sup class="required-star">*</sup></label>
    <input name="branch" type="text" placeholder="Enter Branch Name" required />

    <label>Year <sup class="required-star">*</sup></label>
    <select name="year" required>
      <option value="">Select Year</option>
      <option>1st Year</option>
      <option>2nd Year</option>
      <option>3rd Year</option>
      <option>4th Year</option>
    </select>

    <label>Player Skill <sup class="required-star">*</sup></label>
    <select name="skill" required>
      <option value="">Select Skill</option>
      <option>Batter</option>
      <option>Bowler</option>
      <option>All-Rounder</option>
    </select>

    <label>Contact Number <sup class="required-star">*</sup></label>
    <input name="contact" type="text" placeholder="Enter Contact Number" required />

    <label>Upload Player Photo <sup class="required-star">*</sup></label>
    <input id="photoInput" type="file" accept="image/*" required />
    
    <img id="imgPreview" class="img-preview" />

    <button type="submit">Submit</button>

  </form>
</div>

<!-- SUCCESS POPUP -->
<div id="successPopup" style="
  display:none;position:fixed;top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);
  justify-content:center;align-items:center;">
  <div style="background:#fff8e0;padding:22px;border-radius:15px;border:3px solid #bfa35f;text-align:center;max-width:320px;">
    <h3 style="color:#6b4e16;font-size:22px">üéâ Registration Successful</h3>
    <p style="font-size:16px;color:#3b2f1e;">Your registration has been recorded.</p>
    <button onclick="closePopup()" style="margin-top:12px;background:#b48a3b;color:#fff;padding:10px;border-radius:8px;border:none;cursor:pointer;font-weight:700">OK</button>
  </div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxU15-o5AwaCwl26APeWMH9828ouL0foX4w8tQdBC4_mSiqxK3X7sr4p4QfObbQg368/exec"; // << replace this

const form = document.getElementById('regForm');
const photoInput = document.getElementById('photoInput');
const imgPreview = document.getElementById('imgPreview');

photoInput.addEventListener('change', () => {
  const file = photoInput.files[0];
  if (!file) {
    imgPreview.style.display = "none";
    imgPreview.src = "";
    return;
  }
  const reader = new FileReader();
  reader.onload = evt => {
    imgPreview.src = evt.target.result;
    imgPreview.style.display = "block";
  };
  reader.readAsDataURL(file);
});

function readFileAsBase64(file) {
  return new Promise((resolve, reject) => {
    const fr = new FileReader();
    fr.onload = () => {
      const dataUrl = fr.result;
      const base64 = dataUrl.split(",")[1];
      const mime = dataUrl.substring(5, dataUrl.indexOf(";"));
      resolve({ base64, mime, name: file.name });
    };
    fr.onerror = reject;
    fr.readAsDataURL(file);
  });
}

form.addEventListener('submit', async (e) => {
  e.preventDefault();

  if (!photoInput.files.length) {
    alert("‚ùå Please upload a photo. It is required.");
    return;
  }

  const file = photoInput.files[0];
  const data = await readFileAsBase64(file);

  const fd = new FormData();
  fd.append("playerName", form.playerName.value);
  fd.append("branch", form.branch.value);
  fd.append("year", form.year.value);
  fd.append("skill", form.skill.value);
  fd.append("contact", form.contact.value);
  fd.append("photoData", data.base64);
  fd.append("photoType", data.mime);
  fd.append("photoName", data.name);

  fetch(SCRIPT_URL, { method: "POST", body: fd })
    .then(r => r.json())
    .then(resp => {
      if (resp.success === false && resp.message === "duplicate") {
        alert("‚ùå You have already registered.\nDuplicate entry blocked.");
        return;
      }
      if (resp.success) {
        document.getElementById("successPopup").style.display = "flex";
        form.reset();
        imgPreview.style.display = "none";
      } else {
        alert("‚ùå Error: " + (resp.error || resp.message));
      }
    })
    .catch(err => alert("‚ùå Error: " + err));
});

function closePopup() {
  document.getElementById("successPopup").style.display = "none";
}
</script>

</body>
</html>
